{"ast":null,"code":"import _asyncToGenerator from\"E:\\\\Workspace\\\\mongodb_expressjs_reactjs_nodejs\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _defineProperty from\"E:\\\\Workspace\\\\mongodb_expressjs_reactjs_nodejs\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\defineProperty.js\";import _objectSpread from\"E:\\\\Workspace\\\\mongodb_expressjs_reactjs_nodejs\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _slicedToArray from\"E:\\\\Workspace\\\\mongodb_expressjs_reactjs_nodejs\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\Workspace\\\\mongodb_expressjs_reactjs_nodejs\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from'axios';import{useContext,useState}from'react';import{useNavigate}from'react-router-dom';import{AppContext,actionpayloads}from'../../exportStore';import'./Login.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Login=function Login(){var _useContext=useContext(AppContext),dispatch=_useContext.dispatch;var _useState=useState({email:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),userInput=_useState2[0],setUserInput=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var history=useNavigate();var onChangeHandler=function onChangeHandler(e){setUserInput(_objectSpread(_objectSpread({},userInput),{},_defineProperty({},e.target.name,e.target.value)));//dùng spread operator để gán giá trị cho các trường trong form\n};var onSubmitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var option,response,_response$data$data,token,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;e.preventDefault();option={method:'POST',url:'/api/v1/users/login',data:userInput};_context.next=5;return axios(option);case 5:response=_context.sent;_response$data$data=response.data.data,token=_response$data$data.token,user=_response$data$data.user;localStorage.setItem('token',token);//lưu token vào localStorage\ndispatch(actionpayloads.currentUser(user.username));history('/');_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);setErrorMessage(_context.t0.response.data.message);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function onSubmitHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"form-login mt-5 mb-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-login-container\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"login-text-header text-center\",children:\"Login Account\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"form-login-form\",autoComplete:\"off\",onSubmit:onSubmitHandler,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"div\",{className:\"error-message text-center\",children:errorMessage?\"Error: \".concat(errorMessage):''})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",id:\"email\",name:\"email\",placeholder:\"Email\",value:userInput.email,onChange:onChangeHandler})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group mt-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",name:\"password\",placeholder:\"Password\",value:userInput.password,onChange:onChangeHandler})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group text-right mt-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-custom btn-center\",children:\"Login\"})})]})]})})});};export default Login;","map":{"version":3,"sources":["E:/Workspace/mongodb_expressjs_reactjs_nodejs/frontend/src/components/Login/Login.js"],"names":["axios","useContext","useState","useNavigate","AppContext","actionpayloads","Login","dispatch","email","password","userInput","setUserInput","errorMessage","setErrorMessage","history","onChangeHandler","e","target","name","value","onSubmitHandler","preventDefault","option","method","url","data","response","token","user","localStorage","setItem","currentUser","username","message"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport {useContext, useState} from 'react';\r\nimport {useNavigate} from 'react-router-dom';\r\nimport {AppContext, actionpayloads} from '../../exportStore';\r\nimport './Login.css';\r\n\r\nconst Login = () => {\r\n    const {dispatch} = useContext(AppContext);\r\n    const [userInput, setUserInput] = useState({email: \"\", password: \"\"});\r\n    const [errorMessage, setErrorMessage] = useState(null);\r\n    const history = useNavigate();\r\n    const onChangeHandler = (e) => {\r\n        setUserInput({...userInput, [e.target.name]: e.target.value}) //dùng spread operator để gán giá trị cho các trường trong form\r\n    }\r\n    const onSubmitHandler = async (e) => {\r\n        try{\r\n            e.preventDefault();\r\n            const option = {\r\n                method: 'POST',\r\n                url: '/api/v1/users/login',\r\n                data: userInput\r\n            }\r\n            const response = await axios(option);\r\n            const {token, user} = response.data.data;\r\n            localStorage.setItem('token', token); //lưu token vào localStorage\r\n            dispatch(actionpayloads.currentUser(user.username));\r\n            history('/');\r\n        }catch(err){\r\n            setErrorMessage(err.response.data.message);\r\n        }\r\n    }\r\n    return(\r\n        <>\r\n            <div className=\"form-login mt-5 mb-5\">\r\n                <div className=\"form-login-container\">\r\n                    <h5 className='login-text-header text-center'>Login Account</h5>\r\n                    <form className='form-login-form' autoComplete='off' onSubmit={onSubmitHandler}>\r\n                        <div className=\"form-group\">\r\n                            <div className='error-message text-center'>{errorMessage ? `Error: ${errorMessage}` : ''}</div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <input type='email' className='form-control' id='email' name='email' placeholder='Email' value={userInput.email} onChange={onChangeHandler}/>\r\n                        </div>\r\n                        <div className='form-group mt-4'>\r\n                            <input type='password' className='form-control' id='password' name='password' placeholder='Password' value={userInput.password} onChange={onChangeHandler}/>\r\n                        </div>\r\n                        <div className='form-group text-right mt-4'>\r\n                            <button type='submit' className='btn-custom btn-center'>Login</button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}